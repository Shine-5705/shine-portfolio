---
import style from '../../assets/styles/About.module.scss';
import { Image } from 'astro:assets';
import profileImage from '../../assets/images/profile-image.jpg';
import atomImg from '../../assets/images/atom.png';
import { Target, Lightbulb, Rocket, Palette, Book, Earth, Coffee } from '@lucide/astro';
---

<section class={style.aboutContainer + ' about-container'}>
    <canvas class={style.threeJsCanvas} id="aboutCanvas"></canvas>
    
    <div class={style.floatingImages}>
        <Image src={atomImg} alt="atom" class={style.floatingImg + ' ' + style.img1} />
        <Image src={atomImg} alt="atom" class={style.floatingImg + ' ' + style.img2} />
        <Image src={atomImg} alt="atom" class={style.floatingImg + ' ' + style.img3} />
        <Image src={atomImg} alt="atom" class={style.floatingImg + ' ' + style.img4} />
        <Image src={atomImg} alt="atom" class={style.floatingImg + ' ' + style.img5} />
    </div>

    <div class={style.aboutContent + ' about-content'}>
        <div class={style.sectionHeader + ' section-header'}>
            <span class={style.sectionTag + ' section-tag'}>Get to know me</span>
            <h2 class={style.sectionTitle + ' section-title'}>About Shine</h2>
            <div class={style.titleUnderline + ' title-underline'}></div>
        </div>

        <div class={style.aboutGrid}>
            <div class={style.profileSection + ' profile-section'}>
                <div class={style.imageContainer + ' image-container'}>
                    <div class={style.imageBorder}></div>
                    <div class={style.profileImage + ' profile-image'}>
                        <Image src={profileImage} loading="lazy" layout='constrained' alt="Shine Gupta" class={style.photo} />
                    </div>
                    <div class={style.floatingStats + ' floating-stats'}>
                        <div class={style.stat + ' stat-1'}>
                            <span class={style.statNumber}>50+</span>
                            <span class={style.statLabel}>Projects</span>
                        </div>
                        <div class={style.stat + ' stat-2'}>
                            <span class={style.statNumber}>7</span>
                            <span class={style.statLabel}>Awards</span>
                        </div>
                        <div class={style.stat + ' stat-3'}>
                            <span class={style.statNumber}>99%</span>
                            <span class={style.statLabel}>Success Rate</span>
                        </div>
                    </div>
                </div>
                
                <div class={style.skillsOverview + ' skills-overview'}>
                    <h3 class={style.skillsTitle + ' skills-title'}>Core Expertise</h3>
                    <div class={style.skillBars + ' skill-bars'}>
                        <div class={style.skillBar + ' skill-bar'}>
                            <div class={style.skillInfo}>
                                <span class={style.skillName}>Machine Learning</span>
                                <span class={style.skillPercent}>98%</span>
                            </div>
                            <div class={style.skillProgress}>
                                <div class={style.skillFill + ' skill-fill-ml'} data-percent="98"></div>
                            </div>
                        </div>
                        
                        <div class={style.skillBar + ' skill-bar'}>
                            <div class={style.skillInfo}>
                                <span class={style.skillName}>Data Visualization</span>
                                <span class={style.skillPercent}>95%</span>
                            </div>
                            <div class={style.skillProgress}>
                                <div class={style.skillFill + ' skill-fill-viz'} data-percent="95"></div>
                            </div>
                        </div>
                        
                        <div class={style.skillBar + ' skill-bar'}>
                            <div class={style.skillInfo}>
                                <span class={style.skillName}>Statistical Analysis</span>
                                <span class={style.skillPercent}>96%</span>
                            </div>
                            <div class={style.skillProgress}>
                                <div class={style.skillFill + ' skill-fill-stats'} data-percent="96"></div>
                            </div>
                        </div>
                        
                        <div class={style.skillBar + ' skill-bar'}>
                            <div class={style.skillInfo}>
                                <span class={style.skillName}>Deep Learning</span>
                                <span class={style.skillPercent}>92%</span>
                            </div>
                            <div class={style.skillProgress}>
                                <div class={style.skillFill + ' skill-fill-dl'} data-percent="92"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class={style.contentSection + ' content-section'}>
                <div class={style.storyCard + ' story-card'}>
                  <div class={style.cardHeader}>
                    <div class={style.cardIcon}><Target color="#D7ABC5" size={48} /></div>
                    <h3 class={style.cardTitle + ' card-title'}>My Journey</h3>
                  </div>
                    <p class={style.cardText + ' card-text'}>
                        From a curious mathematics student to a leading data scientist, my journey has been driven by an insatiable appetite for uncovering patterns in chaos. I believe data tells stories that can change the world.
                    </p>
                </div>

                <div class={style.storyCard + ' story-card tech-stack-card'}>
                  <div class={style.cardHeader}>
                    <div class={style.cardIcon}><Lightbulb color='#D7ABC5' size={48} /></div>
                    <h3 class={style.cardTitle + ' card-title'}>Tech Stack</h3>
                  </div>
                    <div class={style.techStackContent}>
                        <div class={style.techCategory}>
                            <h4 class={style.categoryTitle}>Programming Languages</h4>
                            <div class={style.techTags}>
                                <span class={style.techTag}>Python</span>
                                <span class={style.techTag}>C/C++</span>
                                <span class={style.techTag}>JavaScript/TypeScript</span>
                            </div>
                        </div>
                        
                        <div class={style.techCategory}>
                            <h4 class={style.categoryTitle}>AI/ML & Data Science</h4>
                            <div class={style.techTags}>
                                <span class={style.techTag}>PyTorch</span>
                                <span class={style.techTag}>TensorFlow</span>
                                <span class={style.techTag}>scikit-learn</span>
                                <span class={style.techTag}>XGBoost</span>
                                <span class={style.techTag}>Transformers</span>
                                <span class={style.techTag}>Hugging Face</span>
                                <span class={style.techTag}>Generative AI</span>
                                <span class={style.techTag}>RAG pipelines</span>
                                <span class={style.techTag}>LangChain</span>
                                <span class={style.techTag}>LangGraph</span>
                                <span class={style.techTag}>Continuous Thought Machine (CTMs)</span>
                                <span class={style.techTag}>AI Agents</span>
                                <span class={style.techTag}>OpenCV</span>
                                <span class={style.techTag}>NEAT</span>
                                <span class={style.techTag}>Applied AI</span>
                                <span class={style.techTag}>MLOps</span>
                            </div>
                        </div>
                        
                        <div class={style.techCategory}>
                            <h4 class={style.categoryTitle}>Web & Frameworks</h4>
                            <div class={style.techTags}>
                                <span class={style.techTag}>Flask</span>
                                <span class={style.techTag}>FastAPI</span>
                                <span class={style.techTag}>React</span>
                                <span class={style.techTag}>Next.js</span>
                                <span class={style.techTag}>Express.js</span>
                            </div>
                        </div>
                        
                        <div class={style.techCategory}>
                            <h4 class={style.categoryTitle}>Databases</h4>
                            <div class={style.techTags}>
                                <span class={style.techTag}>PostgreSQL</span>
                                <span class={style.techTag}>MySQL</span>
                                <span class={style.techTag}>MongoDB</span>
                                <span class={style.techTag}>Neo4j</span>
                            </div>
                        </div>
                        
                        <div class={style.techCategory}>
                            <h4 class={style.categoryTitle}>Cloud & DevOps</h4>
                            <div class={style.techTags}>
                                <span class={style.techTag}>AWS (EC2, Lambda)</span>
                                <span class={style.techTag}>GCP</span>
                                <span class={style.techTag}>Docker</span>
                                <span class={style.techTag}>Kubernetes</span>

                            </div>
                        </div>
                        
                        <div class={style.techCategory}>
                            <h4 class={style.categoryTitle}>Other Tools & Specializations</h4>
                            <div class={style.techTags}>
                                <span class={style.techTag}>Web Scraping</span>
                                <span class={style.techTag}>NLP</span>
                                <span class={style.techTag}>Multilingual Assistants</span>
                                <span class={style.techTag}>Voice-enabled Chatbots</span>
                                <span class={style.techTag}>MCP (Model Context Protocol)</span>

                            </div>
                        </div>
                    </div>
                </div>

                <!-- <div class={style.storyCard + ' story-card'}>
                  <div class={style.cardHeader}>
                    <div class={style.cardIcon}><Rocket color='#D7ABC5' size={48} /></div>
                    <h3 class={style.cardTitle + ' card-title'}>Impact</h3>
                  </div>
                    <p class={style.cardText + ' card-text'}>
                        My work has helped organizations increase efficiency by 40%, reduce costs by $2M+, and make data-driven decisions that transformed entire business strategies. I don't just analyze data—I create value.
                    </p>
                </div> -->

                <div class={style.personalInfo + ' personal-info'}>
                    <h3 class={style.infoTitle + ' info-title'}>Beyond the Data</h3>
                    <div class={style.infoGrid + ' info-grid'}>
                        <div class={style.infoItem + ' info-item'}>
                            <div class={style.infoIcon}><Palette color='#D7ABC5' size={36} /></div>
                            <div class={style.infoContent}>
                                <span class={style.infoLabel}>Creative Passion</span>
                                <span class={style.infoValue}>Digital Art & Design</span>
                            </div>
                        </div>
                        
                        <div class={style.infoItem + ' info-item'}>
                            <div class={style.infoIcon}><Book color="#D7ABC5" size={36} /></div>
                            <div class={style.infoContent}>
                                <span class={style.infoLabel}>Learning</span>
                                <span class={style.infoValue}>Quantum Computing</span>
                            </div>
                        </div>
                        
                        <div class={style.infoItem + ' info-item'}>
                            <div class={style.infoIcon}><Earth color="#D7ABC5" size={36} /></div>
                            <div class={style.infoContent}>
                                <span class={style.infoLabel}>Impact Goal</span>
                                <span class={style.infoValue}>AI for Social Good</span>
                            </div>
                        </div>
                        
                        <div class={style.infoItem + ' info-item'}>
                            <div class={style.infoIcon}><Coffee color="#D7ABC5" size={36}/></div>
                            <div class={style.infoContent}>
                                <span class={style.infoLabel}>Fuel</span>
                                <span class={style.infoValue}>Coffee & Curiosity</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class={style.experienceTimeline + ' experience-timeline'}>
            <h3 class={style.timelineTitle + ' timeline-title'}>Professional Journey</h3>
            <div class={style.timeline + ' timeline'}>
                <!-- <div class={style.timelineItem + ' timeline-item'}>
                    <div class={style.timelineDate + ' timeline-date'}>Sept 2025 - Present</div>
                    <div class={style.timelineContent + ' timeline-content'}>
                        <h4 class={style.timelineRole}>Software Engineer Intern</h4>
                        <span class={style.timelineCompany}>OWOW (USA)</span>
                        <div class={style.timelineTech}>
                            <span class={style.techTag}>Bug Fixing</span>
                            <span class={style.techTag}>Software Development</span>
                            <span class={style.techTag}>Team Collaboration</span>
                        </div>
                        <p class={style.timelineDesc}>• Working with a team of 5 developers on software bug resolution<br/>• Contributing to product stability and performance improvements<br/>• Collaborating on development workflows and code reviews</p>
                    </div>
                </div> -->
                
                <div class={style.timelineItem + ' timeline-item'}>
                    <div class={style.timelineDate + ' timeline-date'}>Oct 2024 - Present</div>
                    <div class={style.timelineContent + ' timeline-content'}>
                        <h4 class={style.timelineRole}>Data Scientist</h4>
                        <span class={style.timelineCompany}>Turing (USA)</span>
                        <div class={style.timelineTech}>
                            <span class={style.techTag}>Transformers</span>
                            <span class={style.techTag}>FastAPI</span>
                            <span class={style.techTag}>PostgreSQL</span>
                            <span class={style.techTag}>Git</span>
                            <span class={style.techTag}>Docker</span>
                            <span class={style.techTag}>JavaScript</span>
                        </div>
                        <p class={style.timelineDesc}>• Leading team of 5 developers for ServiceNow, Apple, and Amazon clients<br/>• Enhanced LLM conversation quality by 35% through prompt engineering<br/>• Built scalable dev tools using Python, Postgres, and Neo4j</p>
                    </div>
                </div>
                
                <div class={style.timelineItem + ' timeline-item'}>
                    <div class={style.timelineDate + ' timeline-date'}>Jan 2025 - May 2025</div>
                    <div class={style.timelineContent + ' timeline-content'}>
                        <h4 class={style.timelineRole}>Research Trainee</h4>
                        <span class={style.timelineCompany}>DRDO (India)</span>
                        <div class={style.timelineTech}>
                            <span class={style.techTag}>Python</span>
                            <span class={style.techTag}>LangChain</span>
                            <span class={style.techTag}>RAG</span>
                            <span class={style.techTag}>Docker</span>
                            <span class={style.techTag}>LLMs</span>
                            <span class={style.techTag}>Web Scraping</span>
                        </div>
                        <p class={style.timelineDesc}>• Extracted 50,000+ data points via web scraping for AI knowledge base<br/>• Built AI customer support agent with RAG pipelines using LangChain<br/>• Deployed solutions via Docker with comprehensive logging systems</p>
                    </div>
                </div>
                
                <div class={style.timelineItem + ' timeline-item'}>
                    <div class={style.timelineDate + ' timeline-date'}>July 2024 - Nov 2024</div>
                    <div class={style.timelineContent + ' timeline-content'}>
                        <h4 class={style.timelineRole}>Data Scientist</h4>
                        <span class={style.timelineCompany}>Gradstem (USA)</span>
                        <div class={style.timelineTech}>
                            <span class={style.techTag}>Selenium</span>
                            <span class={style.techTag}>NLP</span>
                            <span class={style.techTag}>Puppeteer</span>
                            <span class={style.techTag}>AI Agents</span>
                            <span class={style.techTag}>MLOps</span>
                            <span class={style.techTag}>LLMs</span>
                            <span class={style.techTag}>RAG</span>
                        </div>
                        <p class={style.timelineDesc}>• Developed AI autonomous agents for form-filling and chatbot applications<br/>• Implemented NLP techniques for business process automation<br/>• Streamlined workflows reducing manual effort significantly</p>
                    </div>
                </div>
                
                <div class={style.timelineItem + ' timeline-item'}>
                    <div class={style.timelineDate + ' timeline-date'}>Jun 2023 - Sept 2024</div>
                    <div class={style.timelineContent + ' timeline-content'}>
                        <h4 class={style.timelineRole}>Machine Learning Engineer</h4>
                        <span class={style.timelineCompany}>Business Quant (India)</span>
                        <div class={style.timelineTech}>
                            <span class={style.techTag}>Python</span>
                            <span class={style.techTag}>PaddleOCR</span>
                            <span class={style.techTag}>NLTK</span>
                            <span class={style.techTag}>NLP</span>
                            <span class={style.techTag}>Machine Learning</span>
                        </div>
                        <p class={style.timelineDesc}>• Improved PaddleOCR extraction precision by 20% using NLTK and OpenAI<br/>• Applied custom NLP algorithms on financial reports<br/>• Automated metrics extraction cutting processing time by 30%</p>
                    </div>
                </div>
                
                <div class={style.timelineItem + ' timeline-item'}>
                    <div class={style.timelineDate + ' timeline-date'}>April 2024 - July 2024</div>
                    <div class={style.timelineContent + ' timeline-content'}>
                        <h4 class={style.timelineRole}>AI/ML Developer</h4>
                        <span class={style.timelineCompany}>Drifko (India)</span>
                        <div class={style.timelineTech}>
                            <span class={style.techTag}>Rasa</span>
                            <span class={style.techTag}>Chainlit</span>
                            <span class={style.techTag}>NLP</span>
                            <span class={style.techTag}>Machine Learning</span>
                            <span class={style.techTag}>LLMs</span>
                            <span class={style.techTag}>Docker</span>
                        </div>
                        <p class={style.timelineDesc}>• Designed chatbots using Rasa and Chainlit frameworks<br/>• Leveraged large language models for natural user interactions<br/>• Implemented conversational AI solutions for business automation</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
import { gsap } from 'gsap';
import { ScrollTrigger } from 'gsap/ScrollTrigger';
import * as THREE from 'three';
import { createAboutAnimations } from '../../lib/AboutWASM';

gsap.registerPlugin(ScrollTrigger);

document.addEventListener('DOMContentLoaded', async () => {
  const canvas = document.getElementById('aboutCanvas') as HTMLCanvasElement;
  const aboutContainer = document.querySelector('.about-container') as HTMLElement;
  
  if (canvas && aboutContainer) {
    const scene = new THREE.Scene();
    const renderer = new THREE.WebGLRenderer({
      canvas,
      alpha: true,
      antialias: true
    });

    const updateDimensions = () => {
      const rect = aboutContainer.getBoundingClientRect();
      return { width: rect.width, height: rect.height };
    };

    let { width, height } = updateDimensions();
    const camera = new THREE.PerspectiveCamera(75, width / height, 0.1, 1000);
    
    renderer.setSize(width, height);
    renderer.setClearColor(0x000000, 0);
    camera.position.z = 5;

    const animations = await createAboutAnimations(scene, aboutContainer);
    animations.start();

    let frameCount = 0;
    function animate() {
      requestAnimationFrame(animate);
      renderer.render(scene, camera);
      
      frameCount++;
    }
    animate();

    function handleResize() {
      const newDimensions = updateDimensions();
      width = newDimensions.width;
      height = newDimensions.height;

      camera.aspect = width / height;
      camera.updateProjectionMatrix();
      renderer.setSize(width, height);
      
      animations.handleResize();
    }

    window.addEventListener('resize', handleResize);
  }

  gsap.set(['.section-tag', '.section-title', '.title-underline', '.image-container', '.floating-stats .stat-1', '.floating-stats .stat-2', '.floating-stats .stat-3', '.skills-title', '.skill-bar', '.story-card', '.info-title', '.info-item', '.timeline-title', '.timeline-item'], { opacity: 1 });

  gsap.timeline({
    scrollTrigger: {
      trigger: '.about-container',
      start: 'top 80%',
      end: 'top 20%',
      toggleActions: 'play none none reverse'
    }
  })
  .fromTo('.section-tag', { y: 30, opacity: 0 }, { duration: 0.8, y: 0, opacity: 1, ease: 'power3.out' })
  .fromTo('.section-title', { y: 50, opacity: 0 }, { duration: 1, y: 0, opacity: 1, ease: 'power3.out' }, '-=0.6')
  .fromTo('.title-underline', { scaleX: 0, opacity: 0 }, { duration: 1, scaleX: 1, opacity: 1, ease: 'power3.out' }, '-=0.4');

  gsap.timeline({
    scrollTrigger: {
      trigger: '.profile-section',
      start: 'top 75%',
      end: 'bottom 25%',
      toggleActions: 'play none none reverse'
    }
  })
  .fromTo('.image-container', { scale: 0.8, rotation: 5, opacity: 0 }, { duration: 1.2, scale: 1, rotation: 0, opacity: 1, ease: 'back.out(1.7)' })
  .fromTo('.floating-stats .stat-1', { x: -50, opacity: 0 }, { duration: 1, x: 0, opacity: 1, ease: 'power3.out' }, '-=0.8')
  .fromTo('.floating-stats .stat-2', { y: -50, opacity: 0 }, { duration: 1, y: 0, opacity: 1, ease: 'power3.out' }, '-=0.6')
  .fromTo('.floating-stats .stat-3', { x: 50, opacity: 0 }, { duration: 1, x: 0, opacity: 1, ease: 'power3.out' }, '-=0.4');

  gsap.timeline({
    scrollTrigger: {
      trigger: '.skills-overview',
      start: 'top 80%',
      end: 'bottom 20%',
      toggleActions: 'play none none reverse'
    }
  })
  .fromTo('.skills-title', { y: 30, opacity: 0 }, { duration: 0.8, y: 0, opacity: 1, ease: 'power3.out' })
  .fromTo('.skill-bar', { x: -30, opacity: 0 }, { duration: 0.6, x: 0, opacity: 1, stagger: 0.1, ease: 'power2.out' }, '-=0.4');

  const skillFills = gsap.utils.toArray<HTMLElement>('.skill-fill-ml, .skill-fill-viz, .skill-fill-stats, .skill-fill-dl');
  skillFills.forEach((fill) => {
    const percent = fill.getAttribute('data-percent');
    gsap.fromTo(fill, 
      { width: '0%' },
      {
        width: percent + '%',
        duration: 1.5,
        ease: 'power2.out',
        scrollTrigger: {
          trigger: fill,
          start: 'top 85%',
          toggleActions: 'play none none reverse'
        }
      }
    );
  });

  gsap.timeline({
    scrollTrigger: {
      trigger: '.content-section',
      start: 'top 70%',
      end: 'bottom 30%',
      toggleActions: 'play none none reverse'
    }
  })
  .fromTo('.story-card', 
    { y: 60, rotation: 3, opacity: 0 },
    { duration: 1, y: 0, rotation: 0, opacity: 1, stagger: 0.2, ease: 'back.out(1.2)' }
  );

  gsap.timeline({
    scrollTrigger: {
      trigger: '.personal-info',
      start: 'top 80%',
      end: 'bottom 20%',
      toggleActions: 'play none none reverse'
    }
  })
  .fromTo('.info-title', { y: 30, opacity: 0 }, { duration: 0.8, y: 0, opacity: 1, ease: 'power3.out' })
  .fromTo('.info-item', 
    { scale: 0.8, opacity: 0 },
    { duration: 0.8, scale: 1, opacity: 1, stagger: 0.15, ease: 'back.out(1.4)' }, 
    '-=0.4'
  );

  gsap.timeline({
    scrollTrigger: {
      trigger: '.experience-timeline',
      start: 'top 75%',
      end: 'bottom 25%',
      toggleActions: 'play none none reverse'
    }
  })
  .fromTo('.timeline-title', { y: 40, opacity: 0 }, { duration: 1, y: 0, opacity: 1, ease: 'power3.out' })
  .fromTo('.timeline-item', 
    { x: -80, opacity: 0 },
    { duration: 1.2, x: 0, opacity: 1, stagger: 0.3, ease: 'power3.out' }, 
    '-=0.5'
  );

  gsap.to('.stat-1', {
    y: -15,
    duration: 2.5,
    ease: 'power1.inOut',
    yoyo: true,
    repeat: -1
  });

  gsap.to('.stat-2', {
    y: -20,
    duration: 3,
    ease: 'power1.inOut',
    yoyo: true,
    repeat: -1,
    delay: 0.5
  });

  gsap.to('.stat-3', {
    y: -12,
    duration: 2.8,
    ease: 'power1.inOut',
    yoyo: true,
    repeat: -1,
    delay: 1
  });

  gsap.to('.profile-image', {
    yPercent: -20,
    ease: 'none',
    scrollTrigger: {
      trigger: '.about-container',
      start: 'top bottom',
      end: 'bottom top',
      scrub: 1
    }
  });

  const storyCards = gsap.utils.toArray<HTMLElement>('.story-card');
  storyCards.forEach((card) => {
    const tl = gsap.timeline({ paused: true });
    tl.to(card, { 
      scale: 1.05, 
      y: -10, 
      boxShadow: '0 20px 60px rgba(215, 171, 197, 0.3)',
      duration: 0.3, 
      ease: 'power2.out' 
    });

    card.addEventListener('mouseenter', () => tl.play());
    card.addEventListener('mouseleave', () => tl.reverse());
  });
});
</script>